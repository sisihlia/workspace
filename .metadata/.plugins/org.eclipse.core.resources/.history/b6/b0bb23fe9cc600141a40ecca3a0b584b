package test;
import com.mongodb.BasicDBObject;
import com.mongodb.BulkWriteOperation;
import com.mongodb.BulkWriteResult;
import com.mongodb.Cursor;
import com.mongodb.DB;
import com.mongodb.Mongo;
import com.mongodb.DBCollection;
import com.mongodb.DBCursor;
import com.mongodb.DBObject;
import com.mongodb.MongoClient;
import com.mongodb.ParallelScanOptions;

import java.lang.reflect.Array;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import java.util.Set;
import java.util.TreeSet;

import javax.swing.text.Document;

import org.bson.BasicBSONObject;

import static java.util.concurrent.TimeUnit.SECONDS;
public class mongodb
{
	public mongodb(){
		
	}
	
	public static void selectSingleRecordAndFieldByRecordNumber(DBCollection collection) {
		 //BasicDBObject allQuery = new BasicDBObject("i-object-metadata.val","1");
			BasicDBObject fields = new BasicDBObject();
			fields.put(	"href","coap://[aaaa::444f:4f50:a729:142c]:5683/pwr/w");
		 
			DBCursor cursor = collection.find(fields);
			ArrayList<String> arr = new ArrayList<String>();
			
			while (cursor.hasNext()) {
				//for(DBObject doc : cursor){
			 DBObject obj = (BasicDBObject) cursor.next();
			   //DBObject obj = (BasicDBObject) cursor.next();
			   // for(int i=0;i<obj.size();i++)
			    //	arr.add(obj.getString("i-object-metadata"));
				System.out.println(cursor.next());
			    /*DBObject report = (DBObject) doc.get("i-object-metadata");
			    String reportName =   (String) report.get("val");
			    System.out.println(reportName);*/
			    
			 // BasicObject x = (BasicDBObject)(obj.get("report")).getString("name"); 
			   
			//Object p = ((DBObject) obj.get("i-object-metadata")).get("val");
			// String s = (String) ((BasicBSONObject) p).get("val");
			 //arr.add(p.get("val").toString());
			   
			 // System.out.println((p));
			 //System.out.println(s);
			  
			  //(BasicDBObject)(obj.get("i-object-metadata")).getString("val") ;
			}
			
		
			//String x = arr.get(0);
			//System.out.println(x);
			//return x;*/
			
	
			
	        
	       
	        
	    
	}
	
	public static void main(String[] args){
		   try{   // get the collection name in indicated database
			   mongodb mdb = new mongodb();
			   test test = new test();
			   MongoClient mongo = new MongoClient("localhost", 27017);
			  
			DB db = mongo.getDB("catdemo");
			 DBCollection collection = db.getCollection("items");
			 
			/* DBCursor cursor = collection.find();
			 while(cursor.hasNext()) {
			        System.out.println(cursor.next());}*/
	selectSingleRecordAndFieldByRecordNumber(collection);
	
			
		   }catch(Exception e){
				     System.err.println( e.getClass().getName() + ": " + e.getMessage() );
				  }
			   }
			}