package test;
import com.mongodb.BasicDBObject;
import com.mongodb.BulkWriteOperation;
import com.mongodb.BulkWriteResult;
import com.mongodb.Cursor;
import com.mongodb.DB;
import com.mongodb.Mongo;
import com.mongodb.DBCollection;
import com.mongodb.DBCursor;
import com.mongodb.DBObject;
import com.mongodb.MongoClient;
import com.mongodb.ParallelScanOptions;

import java.lang.reflect.Array;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import java.util.Set;
import java.util.TreeSet;

import javax.swing.text.Document;

import static java.util.concurrent.TimeUnit.SECONDS;
public class mongodb
{
	public mongodb(){
		
	}
	
	public String selectSingleRecordAndFieldByRecordNumber(DBCollection collection) {
		 BasicDBObject allQuery = new BasicDBObject();
			BasicDBObject fields = new BasicDBObject();
			fields.put("item", 1);
		 
			DBCursor cursor = collection.find(allQuery,fields);
			ArrayList<String> arr = new ArrayList<String>();
			//String str;
			//Set<String> found=new TreeSet<String>();
			while (cursor.hasNext()) {
				//String str=cursor.curr().get("item").toString();
			    //arr.add(str);
				//found.add((String)cursor.next().get("item"));
				//System.out.println(cursor.next());
			    BasicDBObject obj = (BasicDBObject) cursor.next();
			    arr.add(obj.getString("item"));
			}
			//for (int i = 0; i<arr.size(); i++)
			//	System.out.println(arr);
			//System.out.println(arr.get(0));
			String x = arr.get(0);
			System.out.println(x);
			return x;
			
			/*DBCursor cursor = coll.find(query);
			ArrayList arr = new ArrayList();
			String str;
			while (cursor.hasNext()) {
			    str=cursor.curr().get("HomeTown").toString();
			    arr.add(str);*/
			
	        
	       
	        
	    
	}
	
	public static void main(String[] args){
		   try{   // get the collection name in indicated database
			   mongodb mdb = new mongodb();
			   test test = new test();
			   MongoClient mongo = new MongoClient("localhost", 27017);
			  
			DB db = mongo.getDB("mydb");
			 DBCollection collection = db.getCollection("mydbColl");
			 
		String y =	mdb.selectSingleRecordAndFieldByRecordNumber(collection);
			//test.postConnection(y);
			 
		//DBCursor item = collection.find(); // get all docs matched
			   /*System.out.println(item.toString()); // [datas, names, system.indexes, users]
			   while(item.hasNext()) {
				    System.out.println(item.next());
				}     
			   
			 /*  String regex = "[\\s;.,:-]";
			String[] s = item.toString().split(regex);
				//for(int i=0; i<s.length; i++){
				System.out.println(Arrays.toString(s));
		        
			 String c =  item.toString();
			 System.out.println(c);
		*/
			
		   
		   }catch(Exception e){
				     System.err.println( e.getClass().getName() + ": " + e.getMessage() );
				  }
			   }
			}